<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>Entrevista Colonoscopia</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- Bibliotecas para gerar PDF (sem html2canvas) -->
  <script src="https://unpkg.com/jspdf@latest/dist/jspdf.umd.min.js"></script>
  <script src="https://unpkg.com/jspdf-autotable@latest/dist/jspdf.plugin.autotable.js"></script>
  <style>
    body { font-family: Arial, sans-serif; background: #f3f8fc; margin: 0; padding: 0; display: flex; justify-content: center; }
    .container { background: #ffffff; padding: 20px; margin: 20px; border-radius: 15px; max-width: 800px; width: 100%; box-shadow: 0px 6px 18px rgba(0,0,0,0.1); }
    h1,h2 { text-align: center; margin-bottom: 15px; }
    h1 { color: #666; font-size: 1.2em; }
    h2 { color: #2a6db0; font-size: 1.5em; }
    fieldset { border: none; margin-bottom: 25px; padding: 0; }
    legend { font-size: 1.2em; font-weight: bold; margin: 20px 0 10px; color: #333; }
    label { display: block; margin-top: 12px; font-weight: bold; font-size: 1.05em; color: #333; }
    input, textarea { width: 100%; padding: 10px; margin-top: 5px; border-radius: 8px; border: 1px solid #bbb; font-size: 1em; box-sizing: border-box; background: #fafafa; }
    .yes-no { margin-top: 6px; display: flex; gap: 20px; flex-wrap: wrap; }
    .yes-no label { font-weight: normal; background: #f0f4f7; padding: 6px 12px; border-radius: 20px; cursor: pointer; }
    .alerta { background: #fff4e6; border: 1px solid #f5c190; padding: 15px; border-radius: 10px; font-size: 0.95em; color: #333; margin-top: 15px; }
    .responsabilidade { font-size: 0.9em; color: #444; background: #f9f9f9; border: 1px solid #ddd; padding: 12px; border-radius: 8px; margin-top: 20px; }
    .botoes-acao { display: flex; flex-direction: column; gap: 10px; margin-top: 25px; }
    button { padding: 15px; color: white; border: none; border-radius: 30px; cursor: pointer; font-size: 1.2em; width: 100%; transition: background 0.3s; }
    button[type="submit"] { background: #2a6db0; }
    button[type="submit"]:hover { background: #1a4e80; }
    .btn-pdf { background: #6c757d; }
    .btn-pdf:hover { background: #5a6268; }
    .btn-pdf:disabled { background: #969ca1; cursor: not-allowed; }
    .tabela-precos { width: 100%; margin-top: 15px; border-collapse: collapse; font-size: 0.9em; }
    .tabela-precos th, .tabela-precos td { border: 1px solid #e0c8a8; padding: 8px 12px; text-align: left; }
    .tabela-precos thead th { background-color: #fce8d1; font-weight: bold; }
    .tabela-precos td:nth-child(2) { text-align: right; font-weight: bold; }
    .info-pagamento h4 { margin-top: 20px; margin-bottom: 10px; color: #333; }
  </style>
</head>
<body>
  <div class="container">
    <h1>Hospital Israelita St. James Jarinu</h1>
    <h2>Entrevista para Elegibilidade<br> Exame de Colonoscopia</h2>
    <form action="https://formsubmit.co/gestaopa@hospitalstjames.com.br" method="POST">
      <!-- ... (demais campos do formul√°rio) ... -->
      <fieldset> <legend>Dados Pessoais</legend> <label>Data da Entrevista:</label> <input type="text" id="dataEntrevista" name="Data da entrevista" readonly> <label>Nome completo:</label><input type="text" name="Nome do paciente" required> <label>Contato:</label><input type="tel" name="Telefone de contato" placeholder="(xx) xxxxx-xxxx" required> <label>Conv√™nio:</label><input type="text" name="Conv√™nio"> <label>Data de nascimento:</label><input type="date" name="Data de nascimento"> </fieldset>
      <fieldset> <legend>Hist√≥rico do Exame</legend> <label>J√° realizou esse exame?</label> <div class="yes-no"><label><input type="radio" name="J√° realizou colonoscopia" value="sim"> Sim</label><label><input type="radio" name="J√° realizou colonoscopia" value="nao"> N√£o</label></div> <label>Quanto tempo faz?</label><input type="text" name="Tempo desde √∫ltimo exame"> <label>Idade:</label><input type="number" name="Idade"> <label>Peso (kg):</label><input type="number" step="0.1" id="peso" name="Peso (kg)" oninput="calcularIMC()"> <label>Altura (m):</label><input type="number" step="0.01" id="altura" name="Altura (m)" oninput="calcularIMC()"> <label>IMC (autom√°tico):</label><input type="text" id="imc" name="IMC" readonly> </fieldset>
      <fieldset> <legend>Hist√≥rico de Sa√∫de</legend> <label>Defici√™ncia neurol√≥gica?</label><div class="yes-no"><label><input type="radio" name="Defici√™ncia neurol√≥gica" value="sim"> Sim</label><label><input type="radio" name="Defici√™ncia neurol√≥gica" value="nao"> N√£o</label></div> <label>Problema card√≠aco (press√£o alta/baixa, marca-passo, angioplastia)?</label><div class="yes-no"><label><input type="radio" name="Problema card√≠aco" value="sim"> Sim</label><label><input type="radio" name="Problema card√≠aco" value="nao"> N√£o</label></div> <label>Qual?</label><input type="text" name="Tipo de problema card√≠aco"> <label>Problema respirat√≥rio?</label><div class="yes-no"><label><input type="radio" name="Problema respirat√≥rio" value="sim"> Sim</label><label><input type="radio" name="Problema respirat√≥rio" value="nao"> N√£o</label></div> <label>Qual?</label><input type="text" name="Tipo de problema respirat√≥rio"> <label>Alergia a medicamento?</label><div class="yes-no"><label><input type="radio" name="Alergia a medicamento" value="sim"> Sim</label><label><input type="radio" name="Alergia a medicamento" value="nao"> N√£o</label></div> <label>Qual?</label><input type="text" name="Medicamento - alergia"> <label>Uso de anticoagulantes (Clop., AAS, Pradaxa, Xarelto ou outros)?</label><div class="yes-no"><label><input type="radio" name="Uso de anticoagulantes" value="sim"> Sim</label><label><input type="radio" name="Uso de anticoagulantes" value="nao"> N√£o</label></div> <label>Qual?</label><input type="text" name="Qual anticoagulante"> <label>Uso de outros medicamentos?</label><div class="yes-no"><label><input type="radio" name="Uso de outros medicamentos" value="sim"> Sim</label><label><input type="radio" name="Uso de outros medicamentos" value="nao"> N√£o</label></div> <label>Quais?</label><textarea name="Quais medicamentos"></textarea> <label>Uso de insulina ou medica√ß√£o p/ diabetes hoje?</label><div class="yes-no"><label><input type="radio" name="Uso de insulina/medica√ß√£o diabetes" value="sim"> Sim</label><label><input type="radio" name="Uso de insulina/medica√ß√£o diabetes" value="nao"> N√£o</label></div> <label>J√° teve hepatite B ou C?</label><div class="yes-no"><label><input type="radio" name="Hepatite B ou C" value="sim"> Sim</label><label><input type="radio" name="Hepatite B ou C" value="nao"> N√£o</label></div> <label>J√° foi sedado?</label><div class="yes-no"><label><input type="radio" name="J√° foi sedado" value="sim"> Sim</label><label><input type="radio" name="J√° foi sedado" value="nao"> N√£o</label></div> <label>Teve algum problema?</label><input type="text" name="Problema na seda√ß√£o"> <label>J√° realizou cirurgia?</label><div class="yes-no"><label><input type="radio" name="J√° realizou cirurgia" value="sim"> Sim</label><label><input type="radio" name="J√° realizou cirurgia" value="nao"> N√£o</label></div> <label>Qual cirurgia?</label><input type="text" name="Qual cirurgia realizada"> <label>Tabagista (fumante)?</label><div class="yes-no"><label><input type="radio" name="Tabagista (fumante)" value="sim"> Sim</label><label><input type="radio" name="Tabagista (fumante)" value="nao"> N√£o</label></div> <label>Consome bebida alco√≥lica (etilista)?</label><div class="yes-no"><label><input type="radio" name="Consome bebida alco√≥lica (etilista)" value="sim"> Sim</label><label><input type="radio" name="Consome bebida alco√≥lica (etilista)" value="nao"> N√£o</label></div> </fieldset>
      <fieldset>
        <legend>Custos Adicionais e Pagamento</legend>
        <div class="alerta info-pagamento">
          <p><strong>Aten√ß√£o: Pacientes Particulares ou com Conv√™nios sem Cobertura para itens adicionais.</strong></p>
          <p>O pagamento do valor base do exame (<strong>Colonoscopia: R$ 900,00</strong>) √© realizado <strong>antes</strong> do procedimento. Custos adicionais, se necess√°rios, s√£o apurados e pagos <strong>ap√≥s</strong> o exame.</p>
          <p>Como o paciente sai do exame sob efeito de seda√ß√£o, √© fundamental que o <strong>acompanhante</strong> esteja ciente e preparado para realizar o pagamento de eventuais valores extras.</p>
          <h4>Tabela de Poss√≠veis Custos Adicionais:</h4>
          <table class="tabela-precos"><thead><tr><th>Servi√ßo Adicional</th><th>Valor (R$)</th><th>Observa√ß√£o</th></tr></thead><tbody><tr><td>Coleta de Bi√≥psia</td><td>216,00</td><td>-</td></tr><tr><td>An√°lise Anatomopatol√≥gica</td><td>118,00</td><td>Por amostra</td></tr><tr><td>Polipectomia (P√≥lipo de Colon)</td><td>800,00</td><td>Caso tenha</td></tr><tr><td>Hemostasia</td><td>1.000,00</td><td>Caso necess√°rio</td></tr><tr><td>Hemoclipes</td><td>678,00</td><td>Caso necess√°rio</td></tr><tr><td>Mucosectomia</td><td>1.000,00</td><td>Caso tenha</td></tr><tr><td>Interna√ß√£o (12h)</td><td>350,00</td><td>Se for necess√°rio</td></tr></tbody></table>
          <h4>Formas de Pagamento:</h4><p>Dinheiro, PIX, D√©bito e Cr√©dito. O parcelamento pode ser negociado a depender do valor total.</p>
        </div>
        <p>Foram claras as informa√ß√µes sobre custos e pagamento?</p>
        <div class="yes-no"><label><input type="radio" name="Ciencia sobre custos" value="sim" required> Sim</label><label><input type="radio" name="Ciencia sobre custos" value="nao"> N√£o</label></div>
        <p>Est√° ciente e de acordo com as condi√ß√µes acima?</p>
        <div class="yes-no"><label><input type="radio" name="Acordo com custos" value="sim" required> Sim</label><label><input type="radio" name="Acordo com custos" value="nao"> N√£o</label></div>
      </fieldset>
      <fieldset> <div class="alerta"> <p><strong>Importante:</strong></p> <p>O atestado m√©dico √© exclusivamente para o <strong>dia do exame</strong> e n√£o abrange os dias de preparo.</p> </div> </fieldset>
      <fieldset> <legend>Declara√ß√£o de Responsabilidade</legend> <div class="responsabilidade"> <p>Declaro que todas as informa√ß√µes prestadas neste formul√°rio s√£o verdadeiras e de minha inteira responsabilidade. Estou ciente de que informa√ß√µes incorretas podem impactar na seguran√ßa e no resultado do exame.</p> </div> <div class="yes-no"><label><input type="radio" name="Declara√ß√£o de responsabilidade" value="declaro" required> Declaro que as informa√ß√µes s√£o verdadeiras</label></div> </fieldset>
      
      <div class="botoes-acao">
        <button type="button" class="btn-pdf" id="btn-pdf-colono" onclick="gerarPDF()">üìÑ Baixar Preparo em PDF</button>
        <button type="submit">üì® Enviar Formul√°rio</button>
      </div>
    </form>
  </div>
  
  <script>
    function gerarPDF() {
      const btn = document.getElementById('btn-pdf-colono');
      btn.disabled = true;
      btn.innerText = 'Gerando PDF...';

      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();

      let y = 15;
      const pageHeight = doc.internal.pageSize.height;
      const margin = 15;
      const maxWidth = doc.internal.pageSize.width - margin * 2;

      function checkPageBreak(currentY) {
        if (currentY > pageHeight - margin) {
          doc.addPage();
          return margin;
        }
        return currentY;
      }
      
      // T√≠tulo Principal
      doc.setFontSize(18);
      doc.setTextColor(42, 109, 176); // #2a6db0
      doc.text("Preparo e Custos - Colonoscopia", doc.internal.pageSize.width / 2, y, { align: 'center' });
      y += 10;
      doc.setDrawColor(200);
      doc.line(margin, y, doc.internal.pageSize.width - margin, y);
      y += 15;

      // Se√ß√£o Informativo
      doc.setFontSize(14);
      doc.setTextColor(42, 109, 176);
      doc.text("Informativo do Procedimento de Colonoscopia", margin, y);
      y += 8;

      doc.setFontSize(10);
      doc.setTextColor(51, 51, 51); // #333
      doc.setFont('helvetica', 'bold');
      doc.text("O que √© Colonoscopia?", margin, y); y += 5;
      doc.setFont('helvetica', 'normal');
      let text = "Colonoscopia √© um exame realizado por m√©dicos especialistas, para diagnosticar e tratar doen√ßas do c√≥lon (intestino grosso). Dura cerca de 30 minutos, sendo realizado sob seda√ß√£o. O exame √© r√°pido, tranquilo e indolor. √â um exame extremamente preciso e muito importante para diversos diagn√≥sticos e tamb√©m para rastreio de c√¢ncer de intestino.";
      let lines = doc.splitTextToSize(text, maxWidth);
      doc.text(lines, margin, y); y += lines.length * 4 + 5;

      y = checkPageBreak(y);
      doc.setFont('helvetica', 'bold');
      doc.text("Como √© feito o exame de Colonoscopia?", margin, y); y += 5;
      doc.setFont('helvetica', 'normal');
      text = "Para permitir a visualiza√ß√£o do intestino √© necess√°rio remover completamente as fezes por meio do preparo intestinal, que tem in√≠cio nos dias que antecedem o exame. O Sr.(a) ser√° encaminhado para sala de exames por um profissional da equipe de enfermagem e ser√° submetido a uma r√°pida entrevista que permite conhecer melhor sua condi√ß√£o de sa√∫de e planejar o procedimento de seda√ß√£o a ser utilizado. Ap√≥s a administra√ß√£o da seda√ß√£o, o m√©dico endoscopista introduz o endosc√≥pio atrav√©s do canal anal e o conduz suavemente atrav√©s do intestino grosso, realizando um exame cuidadoso sem que o paciente sinta desconforto ou dor. A dura√ß√£o aproximada do procedimento √© de 30 minutos. O tempo de perman√™ncia no setor √© de aproximadamente 1 hora.";
      lines = doc.splitTextToSize(text, maxWidth);
      doc.text(lines, margin, y); y += lines.length * 4 + 5;

      // ... continua com o resto dos textos da mesma forma ...
      y = checkPageBreak(y);
      doc.setFont('helvetica', 'bold');
      doc.text("O que acontece ap√≥s a Colonoscopia?", margin, y); y += 5;
      doc.setFont('helvetica', 'normal');
      text = "Terminado o exame, o paciente √© encaminhado para a sala de recupera√ß√£o p√≥s-anest√©sica onde √© monitorado at√© que esteja bem acordado e tenha condi√ß√µes de alta. Ap√≥s o exame normalmente o paciente n√£o apresenta sintomas, sendo raras as manifesta√ß√µes de n√°useas, desconforto abdominal e c√≥lica, sintomas que normalmente melhoram ap√≥s a elimina√ß√£o do ar insuflado no intestino durante o exame. A equipe da endoscopia ir√° inform√°-lo(la) caso exista algum cuidado especial n√£o previsto antes do exame.";
      lines = doc.splitTextToSize(text, maxWidth);
      doc.text(lines, margin, y); y += lines.length * 4 + 5;
      
      y = checkPageBreak(y);
      doc.setFont('helvetica', 'bold');
      doc.text("Quais as poss√≠veis complica√ß√µes com a realiza√ß√£o da Colonoscopia?", margin, y); y += 5;
      doc.setFont('helvetica', 'normal');
      text = "Apesar de todos os cuidados tomados, algumas complica√ß√µes leves podem ocorrer. A incid√™ncia geral de complica√ß√µes em Colonoscopia √© rara, em torno de 1:1000 exames. Complica√ß√µes maiores s√£o extremamente raras e incluem rea√ß√µes medicamentosas, complica√ß√µes card√≠acas e pulmonares. A perfura√ß√£o intestinal pode ocorrer em 0,1% das Colonoscopias diagn√≥sticas e 0,3% das Colonoscopias com procedimentos terap√™uticos. Sangramentos em pequena quantidade podem ocorrer (0,06%) e s√£o controlados durante a Colonoscopia.";
      lines = doc.splitTextToSize(text, maxWidth);
      doc.text(lines, margin, y); y += lines.length * 4 + 5;

      y = checkPageBreak(y);
      doc.setFont('helvetica', 'bold');
      doc.text("O que √© preparo intestinal?", margin, y); y += 5;
      doc.setFont('helvetica', 'normal');
      text = "O preparo intestinal consta de v√°rios procedimentos na v√©spera e no dia do exame para a limpeza completa do intestino grosso.";
      lines = doc.splitTextToSize(text, maxWidth);
      doc.text(lines, margin, y); y += lines.length * 4 + 10;

      // Adiciona uma nova p√°gina se o conte√∫do for muito grande
      doc.addPage();
      y = margin;

      // Se√ß√£o Preparo
      doc.setFontSize(14);
      doc.setTextColor(42, 109, 176);
      doc.text("Como √© feito o preparo intestinal?", margin, y); y+= 10;

      doc.setFontSize(10);
      doc.setTextColor(51, 51, 51);
      doc.setFont('helvetica', 'bold');
      doc.text("2 dias antes do exame", margin, y); y += 6;
      doc.setFont('helvetica', 'normal');
      doc.text("- Caf√© da manh√£: ch√°, suco, √°gua e Gatorade.", margin + 5, y); y+=5;
      doc.text("- Almo√ßo e jantar: macarr√£o miojo, caldos coados, sopa l√≠quida, ovos, pur√™ de batata e gelatina.", margin + 5, y); y+=5;
      doc.setFont('helvetica', 'bold');
      doc.text("Aten√ß√£o - Alimentos proibidos:", margin + 5, y); y+=5;
      doc.setFont('helvetica', 'normal');
      doc.text("- Alimentos com res√≠duos como: verduras frescas ou cozidas, frutas (inclusive casca e semente), alimentos s√≥lidos (arroz, feij√£o, carne, etc), algas ou cogumelos.", margin + 10, y); y+=5;
      doc.text("- L√≠quidos: sucos naturais ou artificiais na cor vermelha, leite, bebida alco√≥lica, caf√©.", margin + 10, y); y+=8;

      y = checkPageBreak(y);
      doc.setFont('helvetica', 'bold');
      doc.text("1 dia antes do exame", margin, y); y += 6;
      doc.setFont('helvetica', 'normal');
      doc.text("- Caf√© da manh√£: ch√°, suco, √°gua de coco, Gatorade.", margin + 5, y); y+=5;
      doc.text("- Almo√ßo e jantar: macarr√£o miojo, caldos coados, sopa l√≠quida, ovos, pur√™ de batata e gelatina.", margin + 5, y); y+=5;
      doc.text("- Tomar dois comprimidos de Dulcolax as 14:00 horas e outros dois comprimidos as 20:00 horas. O Dulcolax pode causar c√≥lica intestinal e, caso n√£o existam contra-indica√ß√µes (como alergia), recomenda-se tomar Buscopam (1 comprimido ou 30 gotas).", margin + 5, y); y+=10;
      doc.text("- O jantar dever√° ser realizado as 19:00 horas, ap√≥s este hor√°rio s√≥ √© permitida a ingest√£o de l√≠quidos claros.", margin + 5, y); y+=5;
      doc.text("- Tome seus medicamentos normalmente.", margin + 5, y); y+=5;
      doc.text("- Tomar bastante l√≠quido neste dia (√°gua, ch√°, suco de frutas coado, √°gua de coco).", margin + 5, y); y+=8;

      y = checkPageBreak(y);
      doc.setFont('helvetica', 'bold');
      doc.text("Dia do exame", margin, y); y += 6;
      doc.setFont('helvetica', 'normal');
      text = "- Cinco horas antes do exame, iniciar o preparo com Manitol. Misture 2 frascos de Manitol(250 ml), um frasco de Simeticona (Luftal) e 500ml de √°gua. A solu√ß√£o ter√° 1 litro e ser√° mais f√°cil de tomar se estiver gelada e se acrescentar suco de um lim√£o.";
      lines = doc.splitTextToSize(text, maxWidth - 5); doc.text(lines, margin + 5, y); y += lines.length * 4 + 2;
      text = "- Tomar um copo de 250 ml da solu√ß√£o a cada 15 minutos, terminando dentro do intervalo de uma hora. Se sentir n√°usea ou v√¥mitos durante o preparo recomenda-se tomar Plasil (1 comprimido ou 30 gotas).";
      lines = doc.splitTextToSize(text, maxWidth - 5); doc.text(lines, margin + 5, y); y += lines.length * 4 + 2;
      text = "- Nesse intervalo, as evacua√ß√µes ser√£o l√≠quidas na cor amarelada e sem res√≠duos. Ap√≥s t√©rmino da mistura, jejum absoluto de quatro horas, antes do exame.";
      lines = doc.splitTextToSize(text, maxWidth - 5); doc.text(lines, margin + 5, y); y += lines.length * 4 + 8;
      
      // Nova P√°gina para Informa√ß√µes e Custos
      doc.addPage();
      y = margin;
      
      doc.setFontSize(14); doc.setTextColor(42, 109, 176); doc.text("Informa√ß√µes Importantes", margin, y); y += 8;
      doc.setFontSize(10); doc.setTextColor(51, 51, 51); doc.setFont('helvetica', 'normal');
      const informacoes = [
        "Os medicamentos para DIABETES e INSULINA n√£o devem ser tomados no dia do exame, devido ao risco de hipoglicemia.",
        "Os rem√©dios di√°rios para press√£o alta e convuls√£o devem ser tomados normalmente.",
        "No dia do exame n√£o use esmalte nem acess√≥rios, como j√≥ias e bijuterias.",
        "Use roupas confort√°veis. Trazer uma troca de roupa.",
        "Traga os exames realizados anteriormente (colonoscopia, endoscopia, tomografia, ultra-som).",
        "Todo paciente dever√° estar acompanhado de uma pessoa maior de 18 anos e n√£o pode dirigir ap√≥s o exame. Respeitando crit√©rios de seguran√ßa e as normas da legisla√ß√£o Brasileira (SS-169/96, CFM 1.409/94 e SS-SP 2/2006) √© obrigat√≥ria a presen√ßa de um acompanhante at√© o retorno do paciente √† sua resid√™ncia. √â proibido dirigir e tomar decis√µes importantes nas 12 horas seguintes ao exame, pois, devido aos medicamentos usados, o paciente pode se manter sonolento e com retardo dos reflexos."
      ];
      informacoes.forEach(info => {
          lines = doc.splitTextToSize("- " + info, maxWidth - 5); doc.text(lines, margin + 5, y); y += lines.length * 4 + 3;
      });
      y += 10;
      
      doc.setFontSize(14); doc.setTextColor(42, 109, 176); doc.text("Custos Adicionais e Pagamento", margin, y); y += 7;
      doc.setFontSize(10); doc.setTextColor(51, 51, 51); doc.setFont('helvetica', 'normal');
      const textosCusto = [
        "Aten√ß√£o: Pacientes Particulares ou com Conv√™nios sem Cobertura para itens adicionais.",
        "O pagamento do valor base do exame (Colonoscopia: R$ 900,00) √© realizado antes do procedimento. Custos adicionais, se necess√°rios, s√£o apurados e pagos ap√≥s o exame.",
        "Como o paciente sai do exame sob efeito de seda√ß√£o, √© fundamental que o acompanhante esteja ciente e preparado para realizar o pagamento de eventuais valores extras."
      ];
      textosCusto.forEach(txt => { lines = doc.splitTextToSize(txt, maxWidth); doc.text(lines, margin, y); y += lines.length * 4 + 3; });
      y += 2;
      
      doc.autoTable({ startY: y, head: [['Servi√ßo Adicional', 'Valor (R$)', 'Observa√ß√£o']], body: [['Coleta de Bi√≥psia', '216,00', '-'], ['An√°lise Anatomopatol√≥gica', '118,00', 'Por amostra'], ['Polipectomia (P√≥lipo de Colon)', '800,00', 'Caso tenha'], ['Hemostasia', '1.000,00', 'Caso necess√°rio'], ['Hemoclipes', '678,00', 'Caso necess√°rio'], ['Mucosectomia', '1.000,00', 'Caso tenha'], ['Interna√ß√£o (12h)', '350,00', 'Se for necess√°rio']], theme: 'grid', headStyles: { fillColor: [240, 244, 247] }, styles: { fontSize: 9 } });
      y = doc.lastAutoTable.finalY + 10;

      doc.setFont('helvetica', 'bold'); doc.text("Formas de Pagamento:", margin, y); y += 5;
      doc.setFont('helvetica', 'normal'); text = "Dinheiro, PIX, D√©bito e Cr√©dito. O parcelamento pode ser negociado a depender do valor total.";
      lines = doc.splitTextToSize(text, maxWidth); doc.text(lines, margin, y);

      doc.save('preparo-colonoscopia.pdf');
      btn.disabled = false;
      btn.innerText = 'üìÑ Baixar Preparo em PDF';
    }

    document.addEventListener("DOMContentLoaded", () => { const hoje = new Date(); const dd = String(hoje.getDate()).padStart(2,'0'); const mm = String(hoje.getMonth()+1).padStart(2,'0'); const yyyy = hoje.getFullYear(); document.getElementById("dataEntrevista").value = `${dd}/${mm}/${yyyy}`; });
    function calcularIMC() { const peso = parseFloat(document.getElementById("peso")?.value); const altura = parseFloat(document.getElementById("altura")?.value); if (peso > 0 && altura > 0) { const imc = (peso / (altura * altura)).toFixed(2); document.getElementById("imc").value = imc; } else { document.getElementById("imc").value = ""; } }
  </script>
</body>
</html>
